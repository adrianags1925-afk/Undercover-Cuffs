<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Permisos para reproducci√≥n autom√°tica de audio -->
<meta http-equiv="Permissions-Policy" content="autoplay=(self), microphone=(), camera=()">
<meta name="referrer" content="no-referrer">
<title>Shop ‚Äì Undercover Cuffs</title>
<style>
    :root {
        color-scheme: dark;
    }
    body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #000;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        color: #f4f4f4;
    }
    .lock-wrapper {
        text-align: center;
    }
    .lock-icon {
        width: 160px;
        max-width: 60vw;
    }
    .lock-text {
        margin-top: 24px;
        font-size: 1.25rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
    }
    
    @media only screen and (max-width: 768px) {
        .lock-icon {
            width: 120px;
            max-width: 50vw;
        }
        
        .lock-text {
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            margin-top: 20px;
            padding: 0 20px;
        }
        
        body {
            padding: 20px;
        }
    }
    
    @media only screen and (max-width: 480px) {
        .lock-icon {
            width: 100px;
            max-width: 45vw;
        }
        
        .lock-text {
            font-size: clamp(0.8rem, 4vw, 1rem);
            margin-top: 15px;
            padding: 0 15px;
        }
        
        body {
            padding: 15px;
        }
    }
    
    /* Audio de fondo oculto */
    #background-audio {
        display: none;
    }
</style>
</head>
<body>
    <div class="lock-wrapper">
        <svg class="lock-icon" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-labelledby="lockTitle lockDesc">
            <title id="lockTitle">Lock</title>
            <desc id="lockDesc">Lock indicating protected shop</desc>
            <path d="M32 10a12 12 0 0 1 12 12v8h-6v-8a6 6 0 0 0-12 0v8h-6v-8A12 12 0 0 1 32 10z" fill="#ffb500"/>
            <rect x="14" y="26" width="36" height="30" rx="6" fill="#ff7a00"/>
            <circle cx="32" cy="41" r="5" fill="#220003"/>
            <rect x="30" y="41" width="4" height="8" rx="2" fill="#220003"/>
        </svg>
        <p class="lock-text">Under Construction</p>
    </div>
    
    <!-- M√∫sica de fondo (sin controles visibles) -->
    <!-- playsinline es CR√çTICO para iOS -->
    <audio id="background-audio" loop preload="auto" playsinline webkit-playsinline style="display: none;">
        <!-- M√∫sica alegre pero tranquila libre de derechos de autor -->
        <!-- Pixabay - m√∫sica tranquila y alegre -->
        <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_73b40dc47e.mp3?filename=soft-background-music-112791.mp3" type="audio/mpeg">
        <!-- Fallback: Pixabay (m√∫sica tranquila alternativa) -->
        <source src="https://cdn.pixabay.com/download/audio/2023/05/11/audio_1683814731.mp3?filename=peaceful-morning-118490.mp3" type="audio/mpeg">
        <!-- Fallback adicional: SoundHelix -->
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" type="audio/mpeg">
        Tu navegador no soporta el elemento de audio.
    </audio>
    
    <script>
        // Sistema de reproducci√≥n de m√∫sica de fondo - SOLUCI√ìN ROBUSTA PARA M√ìVILES
        (function() {
            'use strict';
            
            const audio = document.getElementById('background-audio');
            if (!audio) {
                console.error('Elemento de audio no encontrado');
                return;
            }
            
            // Configurar audio para m√≥viles
            audio.volume = 0.3;
            audio.muted = false;
            
            // CR√çTICO para iOS: establecer playsinline mediante JavaScript tambi√©n
            if ('playsInline' in audio) {
                audio.playsInline = true;
            }
            audio.setAttribute('playsinline', 'true');
            audio.setAttribute('webkit-playsinline', 'true');
            
            let musicPlaying = false;
            let userInteracted = false;
            let audioReady = false;
            
            // Detectar si es un dispositivo m√≥vil
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                            ('ontouchstart' in window) || 
                            (navigator.maxTouchPoints > 0);
            
            // Intentar solicitar permisos de autoplay si est√° disponible
            if ('permissions' in navigator && 'query' in navigator.permissions) {
                navigator.permissions.query({ name: 'autoplay' }).then(function(result) {
                    if (result.state === 'granted') {
                        console.log('‚úÖ Permisos de autoplay concedidos');
                    } else if (result.state === 'prompt') {
                        console.log('‚ö†Ô∏è Permisos de autoplay pendientes');
                    } else {
                        console.log('‚ùå Permisos de autoplay denegados');
                    }
                }).catch(function(error) {
                    // La API puede no estar disponible en todos los navegadores
                    console.log('‚ÑπÔ∏è API de permisos no disponible');
                });
            }
            
            // Funci√≥n robusta para reproducir m√∫sica
            function playMusic(force) {
                if (!audioReady && !force) {
                    return;
                }
                
                // Si ya est√° reproduci√©ndose, no hacer nada
                if (musicPlaying && !audio.paused && !audio.ended) {
                    return;
                }
                
                // Asegurar que no est√© muted
                audio.muted = false;
                
                // Intentar reproducir
                const playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise
                        .then(function() {
                            musicPlaying = true;
                            audio.muted = false;
                            console.log('‚úÖ M√∫sica reproduci√©ndose');
                        })
                        .catch(function(error) {
                            if (isMobile && !userInteracted) {
                                console.log('‚ö†Ô∏è Autoplay bloqueado en m√≥vil. La m√∫sica se activar√° al tocar la pantalla.');
                            }
                        });
                }
            }
            
            // Funci√≥n para iniciar m√∫sica en interacci√≥n (MUY AGRESIVA para m√≥viles)
            function startMusicOnInteraction(e) {
                if (musicPlaying && !audio.paused) {
                    return;
                }
                
                // Marcar interacci√≥n
                if (!userInteracted) {
                    userInteracted = true;
                    console.log('üëÜ Usuario interactu√≥ - Iniciando m√∫sica...');
                }
                
                // Asegurar que el audio est√© listo
                if (!audioReady) {
                    audio.load();
                    audioReady = true;
                }
                
                // Forzar reproducci√≥n inmediata
                audio.muted = false;
                
                // En m√≥viles, intentar m√∫ltiples veces
                if (isMobile) {
                    // Intento inmediato
                    playMusic(true);
                    
                    // Intentos con delays para asegurar
                    var attempts = [10, 50, 100, 200, 300, 500, 800, 1000];
                    attempts.forEach(function(delay) {
                        setTimeout(function() {
                            if (!musicPlaying || audio.paused) {
                                audio.muted = false;
                                playMusic(true);
                            }
                        }, delay);
                    });
                } else {
                    playMusic(true);
                }
            }
            
            // Listener √∫nico y global para capturar CUALQUIER interacci√≥n
            function setupGlobalListener() {
                var handler = function(e) {
                    startMusicOnInteraction(e);
                };
                
                // Eventos cr√≠ticos para m√≥viles (sin 'once' para capturar m√∫ltiples veces)
                var events = ['touchstart', 'touchend', 'click', 'scroll', 'wheel', 'mousedown', 'keydown'];
                
                events.forEach(function(eventType) {
                    // Capturar en fase de captura (m√°s temprano)
                    document.addEventListener(eventType, handler, { capture: true, passive: true });
                    window.addEventListener(eventType, handler, { capture: true, passive: true });
                    
                    if (document.body) {
                        document.body.addEventListener(eventType, handler, { capture: true, passive: true });
                    }
                });
            }
            
            // Cuando el audio est√© listo
            function onAudioReady() {
                audioReady = true;
                console.log('üéµ Audio listo para reproducir');
                
                if (userInteracted || !isMobile) {
                    playMusic(true);
                }
            }
            
            // Event listeners para cuando el audio est√© cargado
            audio.addEventListener('canplay', onAudioReady, { once: false });
            audio.addEventListener('canplaythrough', onAudioReady, { once: false });
            audio.addEventListener('loadeddata', function() {
                audioReady = true;
                if (userInteracted || !isMobile) {
                    setTimeout(function() { playMusic(true); }, 100);
                }
            }, { once: false });
            
            // Cargar el audio
            audio.load();
            
            // Configurar listeners INMEDIATAMENTE
            setupGlobalListener();
            
            // Tambi√©n configurar cuando el DOM est√© listo
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    setupGlobalListener();
                    setTimeout(function() {
                        if (userInteracted || !isMobile) {
                            playMusic(true);
                        }
                    }, 500);
                });
            } else {
                setTimeout(function() {
                    if (userInteracted || !isMobile) {
                        playMusic(true);
                    }
                }, 500);
            }
            
            // Cuando la p√°gina cargue completamente
            window.addEventListener('load', function() {
                audioReady = true;
                setTimeout(function() {
                    if (userInteracted || !isMobile) {
                        playMusic(true);
                    }
                }, 800);
            }, { once: true });
            
            // Manejar cuando el audio termine (reiniciar loop)
            audio.addEventListener('ended', function() {
                audio.currentTime = 0;
                if (userInteracted || musicPlaying) {
                    audio.play().catch(function() {});
                }
            });
            
            // Mantener la m√∫sica reproduci√©ndose si se pausa
            audio.addEventListener('pause', function() {
                if (userInteracted && !audio.ended) {
                    setTimeout(function() {
                        if (audio.paused && userInteracted) {
                            audio.muted = false;
                            audio.play().catch(function() {});
                        }
                    }, 200);
                }
            });
            
            // Verificar peri√≥dicamente el estado (m√°s frecuente en m√≥viles)
            var checkInterval = isMobile ? 300 : 1000;
            setInterval(function() {
                if (userInteracted && audioReady) {
                    if (audio.paused && !audio.ended) {
                        audio.muted = false;
                        audio.play()
                            .then(function() {
                                musicPlaying = true;
                            })
                            .catch(function() {});
                    }
                    // Si la m√∫sica termin√≥, reiniciar
                    if (musicPlaying && audio.ended) {
                        audio.currentTime = 0;
                        audio.muted = false;
                        audio.play().catch(function() {});
                    }
                }
            }, checkInterval);
            
            // En m√≥viles, listeners adicionales
            if (isMobile) {
                // Cuando la p√°gina vuelva a estar visible
                document.addEventListener('visibilitychange', function() {
                    if (!document.hidden && userInteracted && audioReady) {
                        setTimeout(function() {
                            audio.muted = false;
                            playMusic(true);
                        }, 200);
                    }
                });
                
                // Cuando cambie la orientaci√≥n
                window.addEventListener('orientationchange', function() {
                    setTimeout(function() {
                        if (userInteracted && audioReady) {
                            audio.muted = false;
                            playMusic(true);
                        }
                    }, 500);
                });
                
                // Intentar reproducir despu√©s de que el usuario haga cualquier acci√≥n
                window.addEventListener('focus', function() {
                    if (userInteracted && audioReady) {
                        setTimeout(function() {
                            audio.muted = false;
                            playMusic(true);
                        }, 200);
                    }
                });
            }
            
            // Debugging
            audio.addEventListener('error', function(e) {
                console.error('‚ùå Error al cargar el audio:', e);
                if (audio.error) {
                    console.log('C√≥digo:', audio.error.code, 'Mensaje:', audio.error.message);
                }
            });
            
            audio.addEventListener('loadedmetadata', function() {
                console.log('‚úÖ Metadata cargada. Duraci√≥n:', audio.duration, 's');
            });
            
            audio.addEventListener('play', function() {
                console.log('‚ñ∂Ô∏è M√∫sica iniciada');
                musicPlaying = true;
            });
            
            audio.addEventListener('playing', function() {
                console.log('üéµ M√∫sica reproduci√©ndose');
                musicPlaying = true;
            });
            
            if (isMobile) {
                console.log('üì± Dispositivo m√≥vil detectado. Toca la pantalla para activar la m√∫sica.');
            }
        })();
    </script>
</body>
</html>